(self["webpackChunkhivision_idphotos_uniapp"]=self["webpackChunkhivision_idphotos_uniapp"]||[]).push([[965],{1882:function(t,e,o){"use strict";o.r(e);var a=o(31601),n=o.n(a),i=o(76314),r=o.n(i),s=r()(n());s.push([t.id,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* uni.scss */.shake-tag[data-v-10f56f19]{-webkit-animation:shakeAndPause-data-v-10f56f19 1.5s steps(4) infinite;animation:shakeAndPause-data-v-10f56f19 1.5s steps(4) infinite}\n/* 定义关键帧动画 */@-webkit-keyframes shakeAndPause-data-v-10f56f19{0%, 5%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}5%, 10%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}10%, 15%{-webkit-transform:rotate(-6deg);transform:rotate(-6deg)}15%, 20%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}20%, 100%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes shakeAndPause-data-v-10f56f19{0%, 5%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}5%, 10%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}10%, 15%{-webkit-transform:rotate(-6deg);transform:rotate(-6deg)}15%, 20%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}20%, 100%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}\n/* 让每个页面默认高度都是100% */uni-page-body[data-v-10f56f19]{height:100%}div[data-v-10f56f19]{box-sizing:border-box}.cm-dot[data-v-10f56f19]{height:100%;border-radius:50%;width:100%;display:flex;align-items:center;justify-content:center}.cm-dot[data-v-10f56f19]:hover{-webkit-transform:scale(1.1);transform:scale(1.1)}',""]),e["default"]=s},10594:function(t,e,o){"use strict";o.d(e,{A:function(){return f}});var a,n={uTransition:o(60909).A,uLoadingIcon:o(78149).A},i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("u-transition",{attrs:{show:t.loading,"custom-style":{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:t.bgColor,display:"flex"}}},[o("v-uni-view",{staticClass:"u-loading-page"},[o("v-uni-view",{staticClass:"u-loading-page__warpper"},[o("v-uni-view",{staticClass:"u-loading-page__warpper__loading-icon"},[t.image?o("v-uni-image",{staticClass:"u-loading-page__warpper__loading-icon__img",style:{width:t.$u.addUnit(t.iconSize),height:t.$u.addUnit(t.iconSize)},attrs:{src:t.image,mode:"widthFit"}}):o("u-loading-icon",{attrs:{mode:t.loadingMode,size:t.$u.addUnit(t.iconSize),color:t.loadingColor}})],1),t._t("default",[o("v-uni-text",{staticClass:"u-loading-page__warpper__text",style:{fontSize:t.$u.addUnit(t.fontSize),color:t.color}},[t._v(t._s(t.loadingText))])])],2)],1)],1)},r=[],s=(o(2892),{props:{loadingText:{type:[String,Number],default:uni.$u.props.loadingPage.loadingText},image:{type:String,default:uni.$u.props.loadingPage.image},loadingMode:{type:String,default:uni.$u.props.loadingPage.loadingMode},loading:{type:Boolean,default:uni.$u.props.loadingPage.loading},bgColor:{type:String,default:uni.$u.props.loadingPage.bgColor},color:{type:String,default:uni.$u.props.loadingPage.color},fontSize:{type:[String,Number],default:uni.$u.props.loadingPage.fontSize},iconSize:{type:[String,Number],default:uni.$u.props.loadingPage.fontSize},loadingColor:{type:String,default:uni.$u.props.loadingPage.loadingColor}}}),d={name:"u-loading-page",mixins:[uni.$u.mpMixin,uni.$u.mixin,s],data:function(){return{}},methods:{}},c=d,l=(o(13580),o(18535)),u=(0,l.A)(c,i,r,!1,null,"6efac32e",null,!1,n,a),f=u.exports},13580:function(t,e,o){var a=o(66720);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var n=o(69333).A;n("404cbe11",a,!0,{sourceMap:!1,shadowMode:!1})},46246:function(t,e,o){"use strict";o.d(e,{f3:function(){return r},kz:function(){return s},m7:function(){return i}});var a=o(68838),n=o(29307),i=function(t,e,o){return(0,a.QM)("/idphoto","input_image",o,{data:t,method:n.A.POST})},r=function(t,e,o){return(0,a.QM)("/add_background","input_image",o,{data:t,method:n.A.POST})},s=function(t,e,o){return(0,a.QM)("/generate_layout_photos","input_image",o,{data:t,method:n.A.POST})}},55400:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return z}});var a={uOverlay:o(49928).A,uImage:o(35346).A,uButton:o(41303).A,uIcon:o(48732).A,uLoadingPage:o(10594).A},n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"photo-select"},[o("u-overlay",{attrs:{show:t.show},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.show=!1}}},[o("div",{staticClass:"preview-box"},[o("u-image",{attrs:{src:t.imagePath,mode:"aspectFit",height:"1000rpx",radius:"10rpx"}})],1),o("u-button",{staticClass:"bottom-box-btn",attrs:{color:"#F77261","custom-style":{width:"240rpx",borderRadius:"20rpx"}},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmSelect.apply(void 0,arguments)}}},[t._v("确认选择")])],1),o("div",{staticClass:"photo-select-box"},[o("div",{staticClass:"photo-select-box-title"},[t._v(t._s(t.photoSize.name))]),o("div",{staticClass:"photo-select-box-desc"},[o("div",[o("p",[t._v(t._s(t.photoSize.mmWidth)+" x "+t._s(t.photoSize.mmHeight)+" mm")]),o("p",[t._v("冲印尺寸")])]),o("div",[o("p",[t._v(t._s(t.photoSize.pxWidth)+" x "+t._s(t.photoSize.pxHeight)+" px")]),o("p",[t._v("像素大小")])]),o("div",[o("p",[t._v(t._s(t.photoSize.dpi)+" DPI")]),o("p",[t._v("分辨率")])])]),o("div",{staticClass:"photo-select-card"},[o("div",[t._v("支持保存电子照"),o("u-icon",{attrs:{name:"checkmark-circle-fill",color:"#5ac725"}})],1),o("div",[t._v("支持保存电子排版照"),o("u-icon",{attrs:{name:"checkmark-circle-fill",color:"#5ac725"}})],1),o("div",[t._v("背景色"),o("div",{staticClass:"color-dot-box"},t._l(t.colors,function(t,e){return o("ColorDot",{key:e,staticClass:"color-dot",attrs:{color:t}})}),1)]),o("div",[t._v("文件大小"),o("span",[t._v("KB")])]),o("div",[t._v("文件格式"),o("span",[t._v("JPG")])])]),o("div",[t._v("拍照建议")]),o("div",{staticClass:"photo-select-card"},[o("div",[t._v("1.放松身体，挺胸抬头，两眼平视前方")]),o("div",[t._v("2.去掉发饰、眼镜，露出耳朵")]),o("div",[t._v("3.着深色衣服，在白色背景墙前成像效果最佳")])])]),o("div",{staticClass:"bottom-box"},[o("u-button",{attrs:{color:"#F77261","custom-style":{width:"240rpx",borderRadius:"20rpx"},plain:!0,text:"去相册选择"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage("album")}}}),o("u-button",{attrs:{color:"#F77261","custom-style":{width:"240rpx",borderRadius:"20rpx"}},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage("camera")}}},[t._v("去拍照")])],1),o("u-loading-page",{attrs:{loading:t.loading,"loading-text":"正在生成中...","bg-color":"#fff"}})],1)},i=[],r=o(42727),s=o(65376),d=o(50575),c=o(63065),l=o(51729),u=o(54796),f=o(32177),g=o(2775),p=(o(16280),o(76918),o(28706),o(34782),o(79432),o(27495),o(25440),o(31635)),h=o(85476),m=o(21469),v=o(75165),b=o(1089),w=o(46246),_=o(86498),x=o(76779),k=function(t){function e(){var t;(0,c.A)(this,e);for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return t=(0,u.A)(this,e,[].concat(a)),(0,g.A)(t,"form",{height:0,width:0,human_matting_model:"hivision_modnet",face_detect_model:"mtcnn"}),(0,g.A)(t,"colors",x.J.slice(0,5)),(0,g.A)(t,"imagePath",""),(0,g.A)(t,"show",!1),(0,g.A)(t,"loading",!1),(0,g.A)(t,"photoSize",void 0),(0,g.A)(t,"setPhotoPath",void 0),t}return(0,f.A)(e,t),(0,l.A)(e,[{key:"mounted",value:function(){}},{key:"chooseImage",value:function(t){var e=this;uni.chooseImage({count:1,sourceType:[t],success:function(t){var o=t.tempFilePaths[0];e.imagePath=o,e.show=!0}})}},{key:"submit",value:function(){}},{key:"confirmSelect",value:function(){var t=(0,d.A)((0,r.A)().mark(function t(){var e,o,a,n,i,d,c=this;return(0,r.A)().wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e="data:image/png;base64,",o="",a="",n="",i="",this.form.height=this.photoSize.pxHeight,this.form.width=this.photoSize.pxWidth,t.next=10,(0,w.m7)(this.form,"input_image",this.imagePath).then(function(t){if(!t)throw new Error("API返回数据为空");if(console.log("API返回数据:",t),console.log("数据类型:",(0,s.A)(t)),console.log("数据键名:",Object.keys(t)),"success"!==t.status&&!0!==t.status)throw new Error("API处理失败: "+(t.message||"未知错误"));if(o=t.image_base64_standard,a=t.image_base64_hd,console.log("标准证件照base64:",o?"已获取":"未获取"),console.log("高清证件照base64:",a?"已获取":"未获取"),!o)throw new Error("API返回的标准证件照数据不完整");var r=uni.getFileSystemManager();r.writeFile({filePath:n,data:o.replace(e,""),encoding:"base64",success:function(t){console.log(t,"写入本地成功")}}),r.writeFile({filePath:i,data:a.replace(e,""),encoding:"base64",success:function(t){console.log(t,"写入本地成功")}})}).catch(function(t){console.error("生成证件照失败:",t),c.loading=!1,uni.showModal({title:"处理失败",content:"图片处理失败，请检查网络连接或稍后重试",showCancel:!1})});case 10:if(o&&a){t.next=13;break}return this.loading=!1,t.abrupt("return");case 13:d={base64:o,base64HD:a,base64Path:n,base64HDPath:i},this.setPhotoPath(d),uni.navigateTo({url:"/pages/photo/edit",success:function(){c.loading=!1}});case 16:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"skipTo",value:function(){uni.navigateTo({url:"/pages/photo/index"})}}])}(h["default"]);(0,p.Cg)([(0,_.uB)("photoConfig")],k.prototype,"photoSize",void 0),(0,p.Cg)([(0,_.sM)("SET_PHOTO_PATH")],k.prototype,"setPhotoPath",void 0),k=(0,p.Cg)([(0,b.uA)({components:{Card:m.A,ColorDot:v.A}})],k);var y,A=k,P=A,C=(o(62376),o(18535)),S=(0,C.A)(P,n,i,!1,null,"564de782",null,!1,a,y),z=S.exports},62376:function(t,e,o){var a=o(78940);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var n=o(69333).A;n("48934e98",a,!0,{sourceMap:!1,shadowMode:!1})},66720:function(t,e,o){"use strict";o.r(e);var a=o(31601),n=o.n(a),i=o(76314),r=o.n(i),s=r()(n());s.push([t.id,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* uni.scss */.shake-tag[data-v-6efac32e]{-webkit-animation:shakeAndPause-data-v-6efac32e 1.5s steps(4) infinite;animation:shakeAndPause-data-v-6efac32e 1.5s steps(4) infinite}\n/* 定义关键帧动画 */@-webkit-keyframes shakeAndPause-data-v-6efac32e{0%, 5%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}5%, 10%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}10%, 15%{-webkit-transform:rotate(-6deg);transform:rotate(-6deg)}15%, 20%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}20%, 100%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes shakeAndPause-data-v-6efac32e{0%, 5%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}5%, 10%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}10%, 15%{-webkit-transform:rotate(-6deg);transform:rotate(-6deg)}15%, 20%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}20%, 100%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}\n/* 让每个页面默认高度都是100% */uni-page-body[data-v-6efac32e]{height:100%}div[data-v-6efac32e]{box-sizing:border-box}uni-view[data-v-6efac32e], uni-scroll-view[data-v-6efac32e], uni-swiper-item[data-v-6efac32e]{display:flex;flex-direction:column;flex-shrink:0;flex-grow:0;flex-basis:auto;align-items:stretch;align-content:flex-start}.u-loading-page[data-v-6efac32e]{\ndisplay:flex;\nflex-direction:column;flex:1;align-items:center;justify-content:center}.u-loading-page__warpper[data-v-6efac32e]{margin-top:-150px;justify-content:center;align-items:center;color:#c8c8c8;font-size:19px;\ndisplay:flex;\nflex-direction:column}.u-loading-page__warpper__loading-icon[data-v-6efac32e]{margin-bottom:10px}.u-loading-page__warpper__loading-icon__img[data-v-6efac32e]{width:40px;height:40px}.u-loading-page__warpper__text[data-v-6efac32e]{font-size:19px;color:#c8c8c8}',""]),e["default"]=s},75165:function(t,e,o){"use strict";var a;o.d(e,{A:function(){return _}});var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cm-dot",style:{backgroundColor:t.color,border:t.borderColor?"1px solid"+t.borderColor:"none"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._click.apply(void 0,arguments)}}},[t._t("default")],2)},i=[],r=o(63065),s=o(51729),d=o(54796),c=o(32177),l=o(2775),u=(o(28706),o(31635)),f=o(85476),g=o(1089),p=function(t){function e(){var t;(0,r.A)(this,e);for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return t=(0,d.A)(this,e,[].concat(a)),(0,l.A)(t,"name","color-dot"),(0,l.A)(t,"color",void 0),(0,l.A)(t,"gradientColor",void 0),(0,l.A)(t,"borderColor",void 0),t}return(0,c.A)(e,t),(0,s.A)(e,[{key:"_click",value:function(){}}])}(f["default"]);(0,u.Cg)([(0,g.kv)(String)],p.prototype,"color",void 0),(0,u.Cg)([(0,g.kv)(String)],p.prototype,"gradientColor",void 0),(0,u.Cg)([(0,g.kv)(String)],p.prototype,"borderColor",void 0),(0,u.Cg)([(0,g.O5)("click")],p.prototype,"_click",null),p=(0,u.Cg)([g.uA],p);var h,m=p,v=m,b=(o(99302),o(18535)),w=(0,b.A)(v,n,i,!1,null,"10f56f19",null,!1,a,h),_=w.exports},76779:function(t,e,o){"use strict";o.d(e,{J:function(){return a}});var a=["#428eda","#D9001B","#539fed","#b3b3b3","#ac020b","#2c4c80","#ffdad8","#fef7c6","#d1f0dc","#e4d7f3","#c0e8e7","#d0ddf5"]},78940:function(t,e,o){"use strict";o.r(e);var a=o(31601),n=o.n(a),i=o(76314),r=o.n(i),s=r()(n());s.push([t.id,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* uni.scss */.shake-tag[data-v-564de782]{-webkit-animation:shakeAndPause-data-v-564de782 1.5s steps(4) infinite;animation:shakeAndPause-data-v-564de782 1.5s steps(4) infinite}\n/* 定义关键帧动画 */@-webkit-keyframes shakeAndPause-data-v-564de782{0%, 5%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}5%, 10%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}10%, 15%{-webkit-transform:rotate(-6deg);transform:rotate(-6deg)}15%, 20%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}20%, 100%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes shakeAndPause-data-v-564de782{0%, 5%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}5%, 10%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}10%, 15%{-webkit-transform:rotate(-6deg);transform:rotate(-6deg)}15%, 20%{-webkit-transform:rotate(6deg);transform:rotate(6deg)\n    /* 改变数值可以调整抖动的距离 */}20%, 100%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}\n/* 让每个页面默认高度都是100% */uni-page-body[data-v-564de782]{height:100%}div[data-v-564de782]{box-sizing:border-box}.photo-select[data-v-564de782]{height:100%;display:flex;flex-direction:column;padding:0 %?40?%;background-color:#fff}.photo-select-box[data-v-564de782]{height:calc(100% - %?150?%);overflow:hidden;overflow-y:scroll}.photo-select-box-title[data-v-564de782]{width:100%;border-bottom:1px solid #dcdfe6;line-height:%?120?%;font-size:%?50?%;font-weight:700}.photo-select-box-desc[data-v-564de782]{display:flex;justify-content:space-between;font-size:12px;line-height:20px;padding:%?10?% 0}.photo-select-box-desc div[data-v-564de782]{width:33.3%;text-align:center;border-left:1px solid #dcdfe6;line-height:%?30?%}.photo-select-box-desc div > p[data-v-564de782]:first-child{font-weight:700;font-size:.8rem}.photo-select-box-desc div > p[data-v-564de782]:last-child{color:#909399}.photo-select-box-desc > div[data-v-564de782]:first-child{border:none}.photo-select-card[data-v-564de782]{margin:%?20?% 0 %?40?% 0;padding:%?60?% %?40?%;border-radius:%?16?%;background-color:#f8f8f8;color:#909399;display:flex;flex-direction:column;gap:%?40?%}.photo-select-card div[data-v-564de782]{display:flex;justify-content:space-between}.photo-select-card .color-dot[data-v-564de782]{height:%?30?%;width:%?30?%;margin:0 %?6?%}.photo-select .photo-box[data-v-564de782]{height:%?300?%;margin:0 auto;width:calc(100% - %?20?%)}.photo-select .bottom-box[data-v-564de782]{height:%?140?%;display:flex;gap:%?40?%;white-space:nowrap;padding:%?20?% 0;box-sizing:border-box}.photo-select .preview-box[data-v-564de782]{height:calc(100% - %?200?%);display:flex;justify-content:center;width:100%;align-items:center}',""]),e["default"]=s},99302:function(t,e,o){var a=o(1882);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var n=o(69333).A;n("9d3069fa",a,!0,{sourceMap:!1,shadowMode:!1})}}]);